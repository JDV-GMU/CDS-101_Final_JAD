---
title: "Coding"
output: html_document
---

```{r setup}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(modelr))
diamonds <- readr::read_csv("data/sample_data.csv")
```

```{r}
diamond_1 <- diamonds %>%
  select(carat, cut, clarity, price)
```


```{r, fig.width = 8}
diamond_1 %>%
  pivot_longer(cols = cut:clarity,
               names_to = "measurement",
               values_to = "value") %>%
  ggplot() +
    geom_point(mapping = aes(x = value, y = price)) +
    facet_wrap(~ measurement, scales = "free_x")
```
```{r}

diamond_1 %>%
  ggplot() +
  geom_bin2d(aes(x = carat, y = price)) +
  labs(
    title = "Carat vs. Price",
    x = "Carat",
    y = "Price"
  ) + 
scale_fill_viridis_c(trans = "log") 
  #facet_wrap( ~ member_casual)
```

```{r}
Diamond_model_a <- lm(price ~ carat, data = diamond_1)
```
```{r}
Diamond_model_a %>%
  tidy()
```
```{r}
Diamond_model_a %>%
  glance()
```
R squared is close to 1

```{r}
Diamond_model_u <- lm(price ~ cut, data = diamond_1)
```

```{r}
Diamond_model_y <- lm(price ~ clarity, data = diamond_1)
```

```{r}
Diamond_model_u %>%
  tidy()
```


```{r}
Diamond_model_y %>%
  tidy()
```

```{r}
Diamond_model_u %>%
  glance()
```



```{r}
Diamond_model_y %>%
  glance()
```

```{r}
diamond_ma_df <- diamonds %>%
  add_predictions(Diamond_model_a) %>%
  add_residuals(Diamond_model_a)
```
```{r}
diamond_ma_df
```
```{r}
ggplot(diamond_ma_df) +
  geom_bin2d(aes(x = price, y = carat)) +
  labs(
    title = "Carat vs. Price",
    x = "Price",
    y = "Carat"
  ) + 
scale_fill_viridis_c(trans = "log") +
  geom_abline(slope = Diamond_model_a$coefficients[2], intercept = Diamond_model_a$coefficients[1])
```

```{r}
diamond_mu_df <- diamonds %>%
  add_predictions(Diamond_model_u) %>%
  add_residuals(Diamond_model_u)
```
```{r}
diamond_mu_df
```
```{r}
ggplot(diamond_mu_df) +
  geom_point(mapping = aes(x = price, y = cut)) +
  geom_abline(slope = Diamond_model_u$coefficients[2], intercept = Diamond_model_u$coefficients[1])
```

```{r}
diamond_my_df <- diamonds %>%
  add_predictions(Diamond_model_y) %>%
  add_residuals(Diamond_model_y)
```
```{r}
diamond_my_df
```
```{r}
ggplot(diamond_my_df) +
  geom_point(mapping = aes(x = price, y = clarity)) +
  geom_abline(slope = Diamond_model_y$coefficients[2], intercept = Diamond_model_y$coefficients[1])
```

```{r}
diamond_ma_df %>%
  ggplot()+
  geom_histogram(mapping = aes(x = resid), bins = 20) +
  labs(title = "Residuals of Model A")
```
```{r}
diamond_mu_df %>%
  ggplot()+
  geom_histogram(mapping = aes(x = resid), bins = 20) +
  labs(title = "Residuals of Model U")
```
```{r}
diamond_my_df %>%
  ggplot()+
  geom_histogram(mapping = aes(x = resid), bins = 20) +
  labs(title = "Residuals of Model Y")
```
Model for Carat is Skewed left in total, but there is a spike at 0, Cut and clarity are skewed right.

Carat seems to have a higher correlation with Price in comparison to Clarity and Cut.

Source: https://www.vrai.com/journal/post/diamond-carat-price
article by Alicia Briggs | February 06, 2023


"Does The Carat Of A Diamond Affect The Price?
Carat weight is a significant factor in determining the total price of a diamond, but itâ€™s not the only one. The price of a diamond exponentially rises after 1 carat, with a 2 carat diamond often more than double the cost. Why? Because the higher the carat weight, the bigger the loose diamond it was cut from. This means the diamond is rarer and therefore more valuable."


